<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MAT225 • Math Apps</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root { --card:#fff; --bg:#f4f6f8; --ink:#111827; --muted:#6b7280; --blue:#2563eb; --line:#d1d5db; }
    body { margin:0; padding:20px; font-family:system-ui,-apple-system,Segoe UI,Arial,sans-serif; background:var(--bg); color:var(--ink); }
    .wrap { max-width: 1120px; margin: 0 auto; }
    .card { background:var(--card); border-radius:14px; padding:18px 18px 16px; box-shadow:0 8px 20px rgba(0,0,0,.08); }
    h1 { margin: 0 0 6px; font-size: 1.45rem; }
    .sub { margin: 0 0 14px; color: var(--muted); }
    .toolbar { display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; margin-top:8px; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background:#eef2ff; color:#1f2a6d; font-weight:800; }
    .tabs { display:flex; gap:8px; flex-wrap:wrap; margin: 12px 0 14px; }
    .tabbtn { border:1px solid var(--line); background:#fff; color:var(--ink); padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:700; }
    .tabbtn.active { background: var(--blue); color:#fff; border-color:var(--blue); }
    .panel { display:none; }
    .panel.active { display:block; }
    .row { display:flex; gap:16px; flex-wrap:wrap; align-items:flex-start; }
    .box { flex: 1 1 480px; border:1px solid var(--line); border-radius:12px; padding:14px; }
    .boxtitle { margin: 0 0 10px; font-size: 1.05rem; }
    label { font-size: .9rem; color: var(--muted); display:block; margin: 10px 0 6px; }
    input[type="number"] { width:100%; box-sizing:border-box; padding:10px; border:1px solid var(--line); border-radius:10px; font-size:1rem; }
    .grid2 { display:grid; grid-template-columns: repeat(2, 120px); gap:10px; }
    .grid3 { display:grid; grid-template-columns: repeat(3, 120px); gap:10px; }
    .actions { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top: 10px; }
    button { padding:10px 14px; font-size:1rem; border-radius:10px; border:none; background: var(--blue); color:#fff; cursor:pointer; font-weight:800; }
    button:hover { filter: brightness(.95); }
    .out { margin-top:12px; background:#f1f5f9; padding:12px; border-radius:12px; overflow:auto;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: .95rem; white-space: pre-wrap; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <div class="toolbar">
        <div>
          <h1>Math Apps</h1>
          <p class="sub">Tools for MAT225.</p>
        </div>
        <span class="pill">MAT225</span>
      </div>

      <div class="tabs">
        <button class="tabbtn active" data-tab="eigen2">Eigen (2×2)</button>
        <button class="tabbtn" data-tab="eigen3">Eigen (3×3)</button>
      </div>

      <div class="panel active" id="panel-eigen2">
        <div class="row">
          <div class="box">
            <h2 class="boxtitle">2×2 Eigenvalues & Eigenvectors</h2>
            <label>Matrix A = [[a, b], [c, d]]</label>
            <div class="grid2">
              <input id="e2_a" type="number" step="any" value="2" />
              <input id="e2_b" type="number" step="any" value="1" />
              <input id="e2_c" type="number" step="any" value="1" />
              <input id="e2_d" type="number" step="any" value="2" />
            </div>
            <div class="actions">
              <button id="e2_compute">Compute</button>
            </div>
            <div class="out" id="e2_out"></div>
          </div>
        </div>
      </div>

      <div class="panel" id="panel-eigen3">
        <div class="row">
          <div class="box">
            <h2 class="boxtitle">3×3 Eigenvalues & Eigenvectors</h2>
            <label>Matrix A (3×3)</label>
            <div class="grid3">
              <input id="e3_a11" type="number" step="any" value="3" />
              <input id="e3_a12" type="number" step="any" value="0" />
              <input id="e3_a13" type="number" step="any" value="0" />
              <input id="e3_a21" type="number" step="any" value="0" />
              <input id="e3_a22" type="number" step="any" value="2" />
              <input id="e3_a23" type="number" step="any" value="1" />
              <input id="e3_a31" type="number" step="any" value="0" />
              <input id="e3_a32" type="number" step="any" value="1" />
              <input id="e3_a33" type="number" step="any" value="2" />
            </div>

            <div class="actions">
              <button id="e3_compute">Compute</button>
            </div>

            <div class="out" id="e3_out"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

<script type="module">
  import { $, isFiniteAll, fmtComplex, fmtVecComplex, eigen2x2,
           det3, tr3, trA2, cubicRootsRealCoeffs, rowCrossEigenvector3 } from "./shared-math-tools.js";

  // Tabs
  document.addEventListener("click", (ev) => {
    const btn = ev.target;
    if (!btn.classList || !btn.classList.contains("tabbtn")) return;
    const tab = btn.dataset.tab;

    document.querySelectorAll(".tabbtn").forEach(b => b.classList.remove("active"));
    document.querySelectorAll(".panel").forEach(p => p.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById("panel-" + tab).classList.add("active");
  });

  function MAT225_eigen2(){
    const a = parseFloat($("e2_a").value);
    const b = parseFloat($("e2_b").value);
    const c = parseFloat($("e2_c").value);
    const d = parseFloat($("e2_d").value);
    if (!isFiniteAll([a,b,c,d])) { $("e2_out").textContent = "Invalid input."; return; }

    const R = eigen2x2(a,b,c,d);
    $("e2_out").textContent =
`A = [[${a}, ${b}], [${c}, ${d}]]

λ1 = ${fmtComplex(R.lam1)}
v1 = ${fmtVecComplex(R.v1)}

λ2 = ${fmtComplex(R.lam2)}
v2 = ${fmtVecComplex(R.v2)}`;
  }

  function MAT225_eigen3(){
    const A = [
      [parseFloat($("e3_a11").value), parseFloat($("e3_a12").value), parseFloat($("e3_a13").value)],
      [parseFloat($("e3_a21").value), parseFloat($("e3_a22").value), parseFloat($("e3_a23").value)],
      [parseFloat($("e3_a31").value), parseFloat($("e3_a32").value), parseFloat($("e3_a33").value)]
    ];
    if (!A.flat().every(Number.isFinite)) { $("e3_out").textContent = "Invalid input."; return; }

    const t = tr3(A);
    const s = 0.5*(t*t - trA2(A));
    const d = det3(A);

    const lambdas = cubicRootsRealCoeffs(t, s, d);
    const vecs = lambdas.map(lam => rowCrossEigenvector3(A, lam));

    let out = `A =
  [${A[0].join(", ")}]
  [${A[1].join(", ")}]
  [${A[2].join(", ")}]\n\n`;

    for (let k=0;k<3;k++){
      out += `λ${k+1} = ${fmtComplex(lambdas[k])}\n`;
      out += `v${k+1} = ${fmtVecComplex(vecs[k])}\n\n`;
    }
    $("e3_out").textContent = out.trim();
  }

  // Buttons
  document.addEventListener("click", (ev) => {
    const id = ev.target && ev.target.id;
    if (id === "e2_compute") MAT225_eigen2();
    if (id === "e3_compute") MAT225_eigen3();
  });

  // Optional: prefill outputs
  MAT225_eigen2();
  MAT225_eigen3();
</script>
</body>
</html>
